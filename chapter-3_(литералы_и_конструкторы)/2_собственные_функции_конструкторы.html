<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Собственные функции-конструкторы</title>
  </head>
  <body>
    <script>
      // Кроме использования литералов и встроенных функций-конструкторов объекты можно создавать
      // с помощью собственных функций-конструкторов.
      var Person = function(name) {
        this.name = name;
        this.say = function() {
          return "I am " + this.name;
        };
      };

      var adam = new Person("Adam");
      console.log(adam.say());

      /**
       * При вызове функции-конструктора с оператором new внутри функции происходит следующее:
       * - создается пустой объект, наследующий свойства и методы прототипа функции, и ссылка
       *   на него сохраняется в переменной this;
       * - добавление новых свойств и методов в объект осуществляется с помощью ссылки this;
       * - в конце функция неявно возвращает объект, на который ссылается переменная this
       *   (если явно не возвращается никакой другой объект)
       */

      // Значения, возвращаемые конструкторами
      //
      var Objectmaker = function() {
        // это свойство name будет проигнорировано, потому что конструктор
        // возвращает совсем другой объект
        this.name = "This is it";
        // Создать и вернуть новый объект
        var that = {};
        that.name = "And that's that";
        // возвращаться должен объект,
        // строка или логическое значение будут проигнорированы и в этом случае вернется this
        return that;
      };
      // Проверка
      var o = new Objectmaker();
      console.log(o.name); // And that's that
    </script>
  </body>
</html>
